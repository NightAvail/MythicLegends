#######################################################
# Mythic Legends
# Events
#
# Author:  NightAvail
#######################################################

namespace = ml_events_mage
namespace = ml_events_common

# Choose to study magic!
character_event = {
    id = "ml_events_mage.1"
    desc = "ml_events_mage.1desc"
    picture = GFX_evt_meditating_in_temple

    is_triggered_only = yes

    # We should not have magical blood!
    trigger = {
        NOT = { trait = ml_trait_magical_blood }
    }

    # Choose to become a mage with magical blood.
    option = {
        name = "ml_events_mage.1a"

        add_trait = ml_trait_magical_blood

        set_character_flag = ml_flag_choose_mage
    }

    # Choose not to become a mage.
    option = {
        name = "ml_events_mage.1b"

        set_character_flag = ml_flag_choose_not_mage
    }
}

# Choose to become an air mage!
character_event = {
    id = "ml_events_mage.2"
    desc = "ml_events_mage.2desc"
    picture = GFX_evt_meditating_in_temple

    is_triggered_only = yes

    # We should have magical blood and not
    # have choosen a class!
    trigger = {
        trait = ml_trait_magical_blood
        NOT = { has_character_flag = ml_flag_choose_mage_class }
    }

    option = {
        name = "ml_events_mage.2a"

        add_trait = ml_trait_air_mage_beginner
        add_trait = ml_trait_arcane_spell_beginner

        set_character_flag = ml_flag_choose_mage_class
    }
    option = {
        name = "ml_events_mage.nevermind"
    }
}

# Choose to become an earth mage!
character_event = {
    id = "ml_events_mage.3"
    desc = "ml_events_mage.3desc"
    picture = GFX_evt_meditating_in_temple

    is_triggered_only = yes

    # We should have magical blood and not
    # have choosen a class!
    trigger = {
        trait = ml_trait_magical_blood
        NOT = { has_character_flag = ml_flag_choose_mage_class }
    }

    option = {
        name = "ml_events_mage.3a"

        add_trait = ml_trait_earth_mage_beginner
        add_trait = ml_trait_arcane_spell_beginner

        set_character_flag = ml_flag_choose_mage_class
    }
    option = {
        name = "ml_events_common.nevermind"
    }
}

# Choose to become a fire mage!
character_event = {
    id = "ml_events_mage.4"
    desc = "ml_events_mage.4desc"
    picture = GFX_evt_meditating_in_temple

    is_triggered_only = yes

    # We should have magical blood and not
    # have choosen a class!
    trigger = {
        trait = ml_trait_magical_blood
        NOT = { has_character_flag = ml_flag_choose_mage_class }
    }

    option = {
        name = "ml_events_mage.4a"

        add_trait = ml_trait_fire_mage_beginner
        add_trait = ml_trait_arcane_spell_beginner

        set_character_flag = ml_flag_choose_mage_class
    }
    option = {
        name = "ml_events_common.nevermind"
    }
}

# Choose to become a water mage!
character_event = {
    id = "ml_events_mage.5"
    desc = "ml_events_mage.5desc"
    picture = GFX_evt_meditating_in_temple

    is_triggered_only = yes

    # We should have magical blood and not
    # have choosen a class!
    trigger = {
        trait = ml_trait_magical_blood
        NOT = { has_character_flag = ml_flag_choose_mage_class }
    }

    option = {
        name = "ml_events_mage.5a"

        add_trait = ml_trait_water_mage_beginner
        add_trait = ml_trait_arcane_spell_beginner

        set_character_flag = ml_flag_choose_mage_class
    }
    option = {
        name = "ml_events_common.nevermind"
    }
}

# Go on a mage quest!
character_event = {
    id = "ml_events_mage.6"
    desc = "ml_events_mage.6desc"
    picture = GFX_evt_comet
    border = GFX_event_normal_frame_war

    ai = no
    is_triggered_only = yes

    trigger = {
        trait = ml_trait_magical_blood
        NOT = { trait = ml_trait_mage_quest }

        has_character_flag = ml_flag_choose_mage_class
    }

    option = {
        name = "ml_events_common.getstarted"

        add_trait = ml_trait_mage_quest

        # Random chance to stop at an inn to pick up
        # some friends.
        random_list = {
            50 = {
                character_event = {
                    id = "ml_events_mage.6q1"
                    days = 30
                }
            }

            50 = {
                character_event = {
                    id = "ml_events_mage.6q2"
                    days = 30
                }
            }
        }
    }
}

# Mage stops by inn and finds friends.
character_event = {
    id = "ml_events_mage.6q1"
    desc = "ml_events_mage.6q1desc"
    picture = GFX_evt_brothel
    border = "GFX_event_narrative_frame_religion"

    ai = no
    is_triggered_only = yes

    option = {
        name = "ml_events_mage.6q1a"

        set_character_flag = ml_flag_questing_with_friends
    }

    option = {
        name = "ml_events_mage.6q1b"

        clr_character_flag = ml_flag_questing_with_friends
    }
}

# Mage discovers dungeon.
character_event = {
    id = "ml_events_mage.6q2"
    desc = "ml_events_mage.6q2desc"
    picture = GFX_evt_brothel
    border = "GFX_event_narrative_frame_religion"

    ai = no
    is_triggered_only = yes

    # There might be treasure!
    option = {
        name = "ml_events_mage.6q1a"

        random = {
            chance = 10
            add_trait = content
        }
    }

    # I need to end my quest.
    option = {
        name = "ml_events_mage.6q2b"
    }
}
